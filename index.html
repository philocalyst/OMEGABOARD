<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Soundboard</title>
</head>

<body>
  <ul id="soundboard">
    <li><audio preload="" controls="" data-src="sounds/-__AaBqrtj.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/-click-nice.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/-click-nice_3.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/-hd-stardust-crusaders-za-warudo-mp3cut.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/-kizaru-online-audio-converter.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/-nippa-mp3cut.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/-salo-salo-salo-ukranske-salo-mp3cut-net.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/-they-call-me-trinity-whisle.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/-unpum.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/0-debut-de-match.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/00000000000000000.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/000029c2.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/00002a5b.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/006_je_vous_demande.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/007-james-bond-theme_WrKEvuW.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/01-buenas-buenas-tiktok.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/01-faker-what-was-that.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/01-illidan_ultimate2used01.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/01-opening.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/01-power-up-mario.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/01-the-screaming-sheep.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/01_16.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/01_i1WXyWN.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/01d113c213a9a821f066310b8922c598.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/02-coin-snk-vs-capcom-svc-chaos-neo-geo-ost-neogeo.mp3"></audio>
    </li>
    <li><audio preload="" controls="" data-src="sounds/025-kanto-pikachu.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/02_shop-channel-audiotrimmer.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/04357.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/064-laser-thum.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/07-laugh.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/09037.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/096-scream_0vADOL2.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1-000-000-000-iq.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1-1-1.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1-108.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1-2-patate-poil-maudit-cave.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1-a-intro-music-nafpod.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1-b-outro-music-nafpod.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1-booom.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1-booom_1.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1-bullshit-guy.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1-eur.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1-million-beers.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1-sax-romantic.mp3"></audio></li>
    <li><audio preload="" controls=""
        data-src="sounds/1-twitch-hitbox-alert-sounds-donation-follower-sub-sounds.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1-viento-fuerte.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1-welcome-zen.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1-z-10-intro.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/10-android-remix_1QN74k1.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/10-diem.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/10-sec.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/10-second-microwave.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/10-second-squid-game-timer.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/100-piece-p-ssyclat-bacon.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1000-iq.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1000-thr-earthmover-alert-siren.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/10000-khz_hlj8mP5.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/100_X5soDfV.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/104_FqXrzZk.mp3"></audio></li>
    <li><audio preload="" controls=""
        data-src="sounds/1080p-kaguya-sama-wk-03_trim1-online-audio-converter.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/10convert_IOY4md5.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/10convert_pab0Bxs.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/10d.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/10ply.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/111-pokemon-recovery.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1117_241985-audiotrimmer_g9GebRx.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/11900601.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/12-paes.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1231231231312.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1234-flamengo.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/123444.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/123842234723420.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/123_tXjFzsQ.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/123mp3.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/126-shock-horror.mp3"></audio></li>
    <li><audio preload="" controls=""
        data-src="sounds/12661171_short-air-horn-blast_by_sound-ideas_preview.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/12681.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/129-received-an-item.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1293148534528572.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/12_3.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/132273__sl130594__fireworks.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/13565.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/139-item-catch.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/142244.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/15-segundos-de-va-se-lascar-falcao.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/15-the-truck_7MAb6AB.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1500-es-hora-y-media.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/153b-robot-step-sounds-short.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1674.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/167456puaaa.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/168860__orginaljun__light-switch-01.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/16_2.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1738-song.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/180-russ-bray.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/180er-zipfeklatscha.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/18_2.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/19-fortnite-card-who-wants-it-morshu-edition-1.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1950s-version-ksi-thick-of-it.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/195116__mattskydoodle__censor-beep.mp3"></audio></li>
    <li><audio preload="" controls="" data-src="sounds/1980sgamer-timmy-is-that-bad.mp3"></audio></li>
  </ul>
  <script>
    (function () {
      'use strict';

      const BATCH_SIZE = 100;
      let nextIndex = 101;
      let loading = false;
      let hasMore = true;
      let audioFiles = [];

      const ul = document.getElementById('soundboard');
      if (!ul) {
        console.error('No element with id "soundboard" found');
        return;
      }

      // 1) IntersectionObserver for lazy-loading <audio> tags
      const observer = new IntersectionObserver(
        (entries, obs) => {
          entries.forEach((entry) => {
            if (!entry.isIntersecting) return;
            const audio = entry.target;
            if (!audio.src) {
              audio.src = audio.dataset.src;
              audio.preload = 'metadata';
              audio.load();
            }
            obs.unobserve(audio);
          });
        },
        {rootMargin: '200px', threshold: 0.01}
      );

      function registerAudio(audio) {
        if (
          audio instanceof HTMLAudioElement &&
          typeof audio.dataset.src === 'string'
        ) {
          observer.observe(audio);
        }
      }

      // initialize existing <audio data-src="…">
      function initObserver() {
        try {
          document
            .querySelectorAll('audio[data-src]')
            .forEach((a) => registerAudio(a));
        } catch (err) {
          console.error('Error initializing observer:', err);
        }
      }

      // 2) Fetch the manifest once
      async function fetchManifest() {
        try {
          const res = await fetch('./audioFiles.json');
          if (!res.ok) {
            throw new Error(`HTTP ${res.status} – ${res.statusText}`);
          }
          const data = await res.json();
          if (!Array.isArray(data)) {
            throw new TypeError('Manifest is not an array');
          }
          audioFiles = data;
        } catch (err) {
          console.error('Failed to fetch audio manifest:', err);
          hasMore = false;
        }
      }

      // 3) Append a batch of new <audio> items
      function appendAudios(files) {
        files.forEach((src) => {
          try {
            if (typeof src !== 'string') {
              console.warn('Skipping invalid src:', src);
              return;
            }
            const li = document.createElement('li');
            const audio = document.createElement('audio');
            audio.dataset.src = src;
            audio.controls = true;
            audio.preload = 'none';
            li.appendChild(audio);
            ul.appendChild(li);
            registerAudio(audio);
          } catch (err) {
            console.error('Error appending audio for', src, err);
          }
        });
      }

      // 4) Load the next batch when needed
      async function loadMore() {
        if (loading || !hasMore) return;
        loading = true;
        try {
          if (audioFiles.length === 0) {
            await fetchManifest();
          }
          if (audioFiles.length === 0) return;

          const start = nextIndex - 1;
          const slice = audioFiles.slice(start, start + BATCH_SIZE);
          if (slice.length === 0) {
            hasMore = false;
            window.removeEventListener('scroll', onScroll);
            return;
          }
          appendAudios(slice);
          nextIndex += slice.length;
        } catch (err) {
          console.error('Error loading more audios:', err);
        } finally {
          loading = false;
        }
      }

      // 5) Scroll handler: load when you hit near-bottom
      function onScroll() {
        if (!hasMore || loading) return;
        const scrollPos = window.innerHeight + window.pageYOffset;
        const threshold = document.body.offsetHeight - 200;
        if (scrollPos >= threshold) {
          loadMore();
        }
      }

      document.addEventListener('DOMContentLoaded', () => {
        initObserver();
        window.addEventListener('scroll', onScroll, {passive: true});
      });
    })();
  </script>

</body>

</html>